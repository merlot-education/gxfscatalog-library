# Gaia-X Federated Services (GXFS) Federated Catalogue (FC) client library

## Description
This Java-Spring based library intends to simplify interaction with the [federated catalogue](https://gitlab.eclipse.org/eclipse/xfsc/cat/fc-service) (currently supported in version 1.0.1).
In particular it provides the following features:
- **Abstracted communication** with the catalogue API using simple Spring Services
- **Automated login and token refresh** of the provided user interacting with the catalogue
- **Easy self-description creation** using the ready-made models for the basic Gaia-X Trust Framework credential shapes (based on [v22.10](https://gitlab.com/gaia-x/technical-committee/service-characteristics/-/tree/v22.10))
- **Extensibility with custom models** building on top of the the Gaia-X Trust Framework models
- **Easy-to-use signature** of credentials to be published in the catalogue
- **Optional [SD Creation Wizard API](https://gitlab.eclipse.org/eclipse/xfsc/self-description-tooling/sd-creation-wizard-api) pass-through** and interaction for easy [Creation Wizard Frontend](https://gitlab.eclipse.org/eclipse/xfsc/self-description-tooling/sd-creation-wizard-frontend) shape retrieval

## Library structure

## How to use

### Integration into your project
In order to retrieve packages from GitHub you need to generate a personal access token (PAT) including the "read:packages" scope using the [developer settings](https://github.com/settings/tokens).
This token and your username then need to be set in a `settings.xml` file following the following schema:
```
<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0
http://maven.apache.org/xsd/settings-1.0.0.xsd">
    <servers>
        <server>
            <id>github</id>
            <username>YOUR_USERNAME</username>
            <!-- Public token with `read:packages` scope -->
            <password>YOUR_TOKEN</password>
        </server>
    </servers>
</settings>
```
which can be placed in your maven root (typically `~/.m2/settings.xml`).

Afterwards you can head over to the released [packages](https://github.com/merlot-education/gxfscatalog-library/packages/) and add the library to your maven or gradle build pipeline.

### Configuration
The library expects a range of configuration options to be set in the `application.yml` of your project.
Some exemplary values can be found [here](https://github.com/merlot-education/gxfscatalog-library/blob/main/src/main/resources/application.yml).

The following table describes the expected values:

| Key                               | Description                                                                                                                                                                                                                                                                                                   |
|-----------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| gxfscatalog.base-uri              | The base url under which we can access the federated catalogue                                                                                                                                                                                                                                                |
| gxfscatalog.cert-path             | If set to the path of a certificate PEM (e.g. generated by the steps from [here](https://gitlab.com/gaia-x/data-infrastructure-federation-services/cat/fc-tools/signer/#usage)), the internal signer service will use the provided certificate instead of the default GXFS one for signing self-descriptions. |
| gxfscatalog.private-key-path      | See the previous parameter but with the private key PEM.                                                                                                                                                                                                                                                      |
| gxfswizardapi.base-uri            | Optional parameter pointing to the base url under which the SD creation wizard api can be reached if it should be used for pass-through.                                                                                                                                                                      |
| keycloak.client-id                | The client ID set in the Keycloak for the federated catalogue for authentication.                                                                                                                                                                                                                             |
| keycloak.authorization-grant-type | The grant type for authenticating at the keycloak, typically 'password'.                                                                                                                                                                                                                                      |
| keycloak.client-secret            | The client secret of the given client ID for the federated catalogue.                                                                                                                                                                                                                                         |
| keycloak.gxfscatalog-user         | The user that will interact with the catalogue through this library. This user needs sufficient permissions to access the respective endpoints (e.g. by assigning the role `Ro-MU-CA` within Keycloak for full access).                                                                                       |
| keycloak.gxfscatalog-pass         | See the previous parameter, the password of this user is required.                                                                                                                                                                                                                                            |
| keycloak.oidc-base-uri            | Can usually be left as default. Change this if the OIDC base url is configured differently in your Keycloak instance.                                                                                                                                                                                         |
| keycloak.logout-uri               | Can usually be left as default. Change this if the logout url is configured differently in your Keycloak instance.                                                                                                                                                                                            |

### Service Usage

### Extension

## Limitations
Currently, the following catalogue API endpoints are not yet mapped:
- `/schemas` performing CRUD on the enrolled schemas
- `/verification` verifying a given JSON-LD document
- `/users` interacting with the user data of an enrolled Participant 
- `/roles` retrieving the available roles
- `/session` managing auth sessions